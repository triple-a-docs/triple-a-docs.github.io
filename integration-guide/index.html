<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.8.dev">
<meta name="author" content="Triple-A Identity4EO Team">
<title>Triple-A For Exploitation Platforms Integration Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Triple-A For Exploitation Platforms Integration Guide</h1>
<div class="details">
<span id="author" class="author">Triple-A Identity4EO Team</span><br>
<span id="email" class="email">&lt;<a href="mailto:id4eo.contact@deimos-space.com">id4eo.contact@deimos-space.com</a>&gt;</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#trueauthentication">1. Authentication</a>
<ul class="sectlevel2">
<li><a href="#trueconcepts-and-approach">1.1. Concepts and Approach</a>
<ul class="sectlevel3">
<li><a href="#trueauthentication-flows">1.1.1. Authentication Flows</a></li>
<li><a href="#trueclient-authentication">1.1.2. Client authentication</a></li>
<li><a href="#truerequest-endpoints-for-authentication">1.1.3. Request Endpoints for Authentication</a></li>
</ul>
</li>
<li><a href="#trueclient-side-implementation">1.2. Client-side implementation</a>
<ul class="sectlevel3">
<li><a href="#trueregistration">1.2.1. Registration</a>
<ul class="sectlevel4">
<li><a href="#truestatic-registration">1.2.1.1. Static Registration</a></li>
<li><a href="#truedynamic-registration">1.2.1.2. Dynamic Registration</a></li>
<li><a href="#truebasic-example">1.2.1.3. Basic example</a></li>
<li><a href="#trueend-user-clients">1.2.1.4. End-User clients</a></li>
<li><a href="#truetesting-client-for-service-implementers">1.2.1.5. Testing client (for service implementers)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#trueimplementation-solutions-for-js-clients">1.3. Implementation Solutions for JS Clients</a></li>
<li><a href="#trueimplementation-solutions-for-clients-with-back-end">1.4. Implementation Solutions for Clients with Back-end</a></li>
</ul>
</li>
<li><a href="#trueauthorization">2. Authorization</a>
<ul class="sectlevel2">
<li><a href="#truetoken-validation-and-end-user-authorization">2.1. Token Validation and End-user Authorization</a></li>
<li><a href="#trueauthorization-user-managed-access-uma">2.2. Authorization: User Managed Access (UMA)</a>
<ul class="sectlevel3">
<li><a href="#trueauthorization-flow">2.2.1. Authorization Flow</a></li>
<li><a href="#trueresource-managing">2.2.2. Resource Managing</a></li>
<li><a href="#truepolicy-enforcement-pep">2.2.3. Policy Enforcement (PEP)</a></li>
<li><a href="#truepolicy-decision-pdp">2.2.4. Policy Decision (PDP).</a></li>
<li><a href="#truetoken-introspection">2.2.5. Token Introspection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="trueauthentication"><a class="anchor" href="#trueauthentication"></a>1. Authentication</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="trueconcepts-and-approach"><a class="anchor" href="#trueconcepts-and-approach"></a>1.1. Concepts and Approach</h3>
<div class="sect3">
<h4 id="trueauthentication-flows"><a class="anchor" href="#trueauthentication-flows"></a>1.1.1. Authentication Flows</h4>
<div class="paragraph">
<p>In order to interact with this service, it is necessary to implement one of the three authorization flows defined by OpenID Connect 1.0 standard: implicit flow, authorization code flow and hybrid flow.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implicit flow. This method is recommended for browser-based apps. Its main steps are:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A request is made to the Authorization Endpoint. The Authorization Server will redirect the user to the sign-in page.</p>
</li>
<li>
<p>The end-user will then authenticate with a set of required credentials.</p>
</li>
<li>
<p>The Authorization Server will answer back with a redirection URI and an Access Token.</p>
</li>
<li>
<p>The Access Token can be used to request information about the end-user via the User Info Endpoint.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Authorization Code flow. This method is recommended for apps running on a web server or native mobile applications. Its main steps are:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A request is made to the Authorization Endpoint. The Authorization Server service will redirect the user to the sign-in page.</p>
</li>
<li>
<p>The end-user will then authenticate with a set of credentials required.</p>
</li>
<li>
<p>The Authorization Server will answer back with an authorization code.</p>
</li>
<li>
<p>The Client can now use the received code to request an Access Token through the Token Endpoint.</p>
</li>
<li>
<p>Once the client application has acquired an Access Token, it will be possible to request information about the end-user via the User Info Endpoint.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Hybrid Code flow. This method merges characteristic from both of the previously mentioned methods. Currently, the usage of this method is not recommended with the Authorization Server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To implement any of the flows, it is necessary to specify the response type on the request to the Authorization Server. OpenID Connect specification indicates the combination of response types necessary to implement each flow:</p>
</div>
<div id="img_oidc_reponse_types" class="imageblock text-center">
<div class="content">
<img src="images/oidc_response_types.PNG" alt="oidc response types" width="300">
</div>
<div class="title">Figure 1. Response Types on OpenID Connect</div>
</div>
</div>
<div class="sect3">
<h4 id="trueclient-authentication"><a class="anchor" href="#trueclient-authentication"></a>1.1.2. Client authentication</h4>
<div class="paragraph">
<p>When accessing the Token Endpoint, clients using the implicit flow are not required to be authenticated, but if the client uses the Authorization Code Flow, it must provide its credentials.</p>
</div>
<div class="paragraph">
<p>These credentials will be provided by Triple-A: client_id and client_secret.</p>
</div>
</div>
<div class="sect3">
<h4 id="truerequest-endpoints-for-authentication"><a class="anchor" href="#truerequest-endpoints-for-authentication"></a>1.1.3. Request Endpoints for Authentication</h4>
<div class="paragraph">
<p>All endpoints require a set of mandatory parameters in order to generate a valid response. Their URLs can be obtained by means of a Discovery URI that answers back with a set of endpoints and their URLs. All these URLs must be accessed by means of a GET request, and require a set of mandatory parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Discovery URI</strong>: /.well-known/openid-configuration</p>
</li>
<li>
<p><strong>Authorization Endpoint</strong> (GET): /oxauth/restv1/authorize
Parameters:</p>
<div class="ulist">
<ul>
<li>
<p>scope: The request should include an array of scopes, with one of them being “openid”.</p>
</li>
<li>
<p>response_type: Its value should be desired combination according to the OpenID Connect response type table.</p>
</li>
<li>
<p>client_id: Provided by Triple-A.</p>
</li>
<li>
<p>redirect_uri: It should point to the client application and match the URI given on the acceptance request.</p>
</li>
<li>
<p>state (optional): Opaque value used to maintain state between the request and the callback. Typically, Cross-Site Request Forgery (CSRF, XSRF) mitigation is done by cryptographically binding the value of this parameter with a browser cookie.</p>
</li>
<li>
<p>nonce (optional/<strong>required for Implicit Flow</strong>): String value used to associate a Client session with an ID Token, and to mitigate replay attacks (it can have ANY value)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET oxauth/restv1/authorize?scope=openid&amp;client_id=@!5C7F.E36B.5DE3.15EE!0001!6B53.87B4!0008!A121.D32B.8BCD.4E14&amp;redirect_uri=app://test&amp;response_type=code</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the application is trying to authenticate without user input, user credentials must be provided through the Authorization header. The code will be encoded as a parameter in the Location response header.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Token Endpoint</strong> (POST): /oxauth/restv1/token</p>
<div class="ulist">
<ul>
<li>
<p>grant_type: implicit / authorization_code (depending on the authorization flow).</p>
</li>
<li>
<p>Code*: Used only with grant_type=authorization_code</p>
</li>
<li>
<p>redirect_uri: It should point to the client application and match the URI given on the acceptance request.</p>
</li>
<li>
<p>scope: The request should include an array of scopes, with one of them being “openid”.</p>
</li>
<li>
<p>client_id*: Provided by Triple-A, only necessary with grant_type=authorization_code.</p>
</li>
<li>
<p>client_secret*: Provided by Triple-A, only necessary with grant_type=authorization_code</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueclient-side-implementation"><a class="anchor" href="#trueclient-side-implementation"></a>1.2. Client-side implementation</h3>
<div class="sect3">
<h4 id="trueregistration"><a class="anchor" href="#trueregistration"></a>1.2.1. Registration</h4>
<div class="sect4">
<h5 id="truestatic-registration"><a class="anchor" href="#truestatic-registration"></a>1.2.1.1. Static Registration</h5>
<div class="paragraph">
<p>In order to allow a client application to delegate its sign-in function under the SSO system of the Authorization Server, it is necessary to provide the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Application Type: An application could be either NATIVE or WEB.</p>
</li>
<li>
<p>Policy and ToS URI: These resources contain the application policies regarding the usage of user personal information.</p>
</li>
<li>
<p>Redirect Login/Logout URI: Only the first is mandatory. Indicates the URL or App Link where the sign-in service will redirect users after login.
<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</li>
<li>
<p>Required OAuth2 Scopes: These scopes indicate which kind of information and access the Client Application is able to grant to users.
<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After the application has been approved and configured, the following parameters, necessary to connect to the SSO service, will be provided to the client:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Client ID: Unique identification sequence for your client.</p>
</li>
<li>
<p>Client Secret: Necessary to perform Authentication on the Token Endpoint.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Client credentials can be passed either as an Authorization header (encoded as Basic) or in the form of the POST request. Only one of these options can be enabled at the same time for each client.</p>
</div>
</div>
<div class="sect4">
<h5 id="truedynamic-registration"><a class="anchor" href="#truedynamic-registration"></a>1.2.1.2. Dynamic Registration</h5>
<div class="paragraph">
<p>Another way of registering clients is through the dynamic register method defined on the OAuth2.0 specification and extended to allow OpenID Connect parameters.</p>
</div>
<div class="paragraph">
<p>This method allows the client to automatically register itself, receiving all the necessary parameters in order to integrate to the security service. Clients registered using this method will inevitably have an expiration date and its usage implies the necessity of restricting the use of the functionality to avoid exploits or security breaches.</p>
</div>
<div class="paragraph">
<p>In order to register a new client, a call must be performed to the register API Endpoint. The only mandatory parameters are <strong>redirect_uris</strong> and <strong>client_name</strong>. The rest of the parameters on this request are completely optional, which means that the Authorization Server will fill in values by default. In any case, the client can initially create a client with default configuration and update it afterward using methods described in this section.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Register Endpoint</strong> (POST): /oxauth/restv1/register</p>
<div class="ulist">
<ul>
<li>
<p>redirect_uris (mandatory): array of strings containing the redirect_uris for the client</p>
</li>
<li>
<p>client_name (mandatory): string containing the client name</p>
</li>
<li>
<p>response_types: array of strings containing the desired response types</p>
</li>
<li>
<p>grant_types: array of strings containing the desired grant types</p>
</li>
<li>
<p>application_type: can either be "web" or "native"</p>
</li>
<li>
<p>subject_type: can either be pairwise (each user is assigned a unique "sub" parameter) or public</p>
</li>
<li>
<p>token_auth_method: identifies the authentication method when retrieving tokens from the Token Endpoint</p>
</li>
<li>
<p>default_max_age: indicates the max age for tokens obtained using this client</p>
</li>
<li>
<p>default_acr_values: there is no need to assign any value to this parameter, but if set to "passport", it will redirect the user to the mediation service.</p>
</li>
<li>
<p>[Other parameters]</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a wide variety of parameters that can be configured on this request and all of them can be checked on the discovery document:</p>
</div>
<div class="listingblock">
<div class="title">Disovery document JSON:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET /.well-known/openid-configuration</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, if the client wants to use signed JSON Web Tokens, it is necessary to include the corresponding parameter in the call to the Register Endpoint. The discovery document has a field named "id_token_signed_response_alg_values_supported" with several signing methods. One of them can be selected by the client and passed through the parameter "id_token_signed_response_alg".</p>
</div>
<div class="paragraph">
<p>There is only ONE parameter that is not configurable through this dynamic method and that is the "scopes" parameter. These are filled in by the authorization server for security purposes based on the parameters received on the request. Testbed-14 behavior will be to assign the same limited scopes to all dynamic clients, but it is possible to restrict scopes based on domain, grant_types or any other parameter.</p>
</div>
<div class="paragraph">
<p>Any call to the Register Endpoint will have the Authorization Server answer back with a JSON document that indicates metadata about the recently generated client. In particular, there will be two additional fields that can be of use to the client and those are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>registration_access_token</strong>: a bearer token that allows the requester to list or modify metadata about a specific client</p>
</li>
<li>
<p><strong>registration_client_uri</strong>: a URI assigned to a specific client for further interactions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are mainly two more actions that can be performed with these parameters:</p>
</div>
<div class="listingblock">
<div class="title">Client metadata retrieval:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET &lt;registration_client_uri&gt; -H "Authorization: Bearer registration_access_token"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Client metadata update:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">PUT &lt;registration_client_uri&gt; -H "Authorization: Bearer registration_access_token" + JSON_BODY</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truebasic-example"><a class="anchor" href="#truebasic-example"></a>1.2.1.3. Basic example</h5>
<div class="paragraph">
<p>The most basic example for dynamic client registration would be:</p>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">POST /oxauth/restv1/register
{
         "redirect_uris": [
              "https://client.example.org/callback",
              "https://client.example.org/callback2"
          ],
         "client_name": "Basic Client"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Authorization Server would respond with the following information (example):</p>
</div>
<div class="listingblock">
<div class="title">Example of registration response:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
  "client_id": "@!27B7.E085.07A1.6DE7!0002!F5E4.0B8E!0008!C14A.232C.E89C.C514",
  "client_secret": "b2a5fc13-3593-4100-8287-db844b4845f2",
  "registration_access_token": "dee762cf-b134-4e2b-81fd-1238c9299135",
  "registration_client_uri": "https://testbed14-sso.elecnor-deimos.com/oxauth/restv1/register?client_id=@!27B7.E085.07A1.6DE7!0002!F5E4.0B8E!0008!C14A.232C.E89C.C514",
  "client_id_issued_at": 1533812916,
  "client_secret_expires_at": 1533816516,
  "redirect_uris": [
    "https://client.example.org/callback",
    "https://client.example.org/callback2"
  ],
  "response_types": ["code"],
  "grant_types": [
    "authorization_code",
    "refresh_token"
  ],
  "application_type": "web",
  "client_name": "Basic Client",
  "subject_type": "pairwise",
  "id_token_signed_response_alg": "RS256",
  "token_endpoint_auth_method": "client_secret_basic",
  "require_auth_time": false,
  "frontchannel_logout_session_required": false,
  "scopes": [
    "openid",
    "uma_protection",
    "permission",
    "user_name",
    "email",
    "profile"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Behavior by default is to utilize the Authorization Code grant, allowing refresh tokens, and the default set of scopes can be seen in the example. The client secret has also been randomly generated.</p>
</div>
</div>
<div class="sect4">
<h5 id="trueend-user-clients"><a class="anchor" href="#trueend-user-clients"></a>1.2.1.4. End-User clients</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">POST /oxauth/restv1/register
{
      "redirect_uris": [
        "https://client.example.org/callback",
        "https://client.example.org/callback2"],
      "client_name": "D142 Client",
      "token_endpoint_auth_method": "client_secret_post",
      "response_types": ["token", "id_token", "code"],
      "default_acr_values": ["passport"],
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The "default_acr_values" set to "passport" allows the service to be redirected through a mediation service (with federation options).</p>
</div>
</div>
<div class="sect4">
<h5 id="truetesting-client-for-service-implementers"><a class="anchor" href="#truetesting-client-for-service-implementers"></a>1.2.1.5. Testing client (for service implementers)</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">POST /oxauth/restv1/register
{
      "redirect_uris": [
        "https://client.example.org/callback"],
      "client_name": "WFS Service Example",
      "token_endpoint_auth_method": "client_secret_post",
      "grant_types": ["password"]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueimplementation-solutions-for-js-clients"><a class="anchor" href="#trueimplementation-solutions-for-js-clients"></a>1.3. Implementation Solutions for JS Clients</h3>
<div class="paragraph">
<p>For web-based clients, there are several Free and Open Source JavaScript solutions available that could implement the implicit flow. In general, all of them perform a call against the Authorization Endpoint:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Authorization Endpoint</strong> (GET): /oxauth/restv1/authorize</p>
<div class="ulist">
<ul>
<li>
<p>scope: “openid geoss_user”.</p>
</li>
<li>
<p>response_type: “id_token token”.</p>
</li>
<li>
<p>client_id: Provided by Triple-A.</p>
</li>
<li>
<p>redirect_uri: &lt;TBD&gt;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET /oxauth/restv1/authorize?scope=openid%20geoss_user&amp;client_id=&lt;TBD&gt;&amp;redirect_uri=&lt;TBD&gt;&amp;response_type=id_token%20token</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueimplementation-solutions-for-clients-with-back-end"><a class="anchor" href="#trueimplementation-solutions-for-clients-with-back-end"></a>1.4. Implementation Solutions for Clients with Back-end</h3>
<div class="paragraph">
<p>For back-end powered clients, there are several Free and Open Source solutions available that could implement the authorization code flow. In general, all of them perform a call against the Authorization Endpoint to retrieve a code and then exchange it for a token on the Token Endpoint:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Authorization Endpoint</strong> (GET): /oxauth/restv1/authorize</p>
<div class="ulist">
<ul>
<li>
<p>scope: “openid geoss_user”.</p>
</li>
<li>
<p>response_type: “code”.</p>
</li>
<li>
<p>client_id: Provided by Triple-A.</p>
</li>
<li>
<p>redirect_uri: &lt;TBD&gt;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET /oxauth/restv1/authorize?scope=openid%20geoss_user&amp;client_id=&lt;TBD&gt;&amp;redirect_uri=&lt;TBD&gt;&amp;response_type=code</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Token Endpoint</strong> (POST): /oxauth/restv1/token</p>
<div class="ulist">
<ul>
<li>
<p>scope: “openid geoss_user”.</p>
</li>
<li>
<p>grant_type: authorization_code.</p>
</li>
<li>
<p>code: Obtained on the previous request.</p>
</li>
<li>
<p>client_id: Provided by Triple-A.</p>
</li>
<li>
<p>client_secret: Provided by Triple-A</p>
</li>
<li>
<p>redirect_uri: &lt;TBD&gt;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">POST /oxauth/restv1/token -d 'scope=openid%20geoss_user&amp;client_id=&lt;TBD&gt;&amp;client_secret=&lt;TBD&gt;&amp;redirect_uri=&lt;TBD&gt;&amp;grant_type=authorization_code&amp;code=&lt;CODE&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueauthorization"><a class="anchor" href="#trueauthorization"></a>2. Authorization</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truetoken-validation-and-end-user-authorization"><a class="anchor" href="#truetoken-validation-and-end-user-authorization"></a>2.1. Token Validation and End-user Authorization</h3>
<div class="paragraph">
<p>Use this Endpoint to acquire user information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>User-Info Endpoint (GET)</strong>: /oxauth/restv1/userinfo</p>
<div class="ulist">
<ul>
<li>
<p>access_token: Acquired via Token or Authorization endpoints.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET oxauth/restv1/userinfo?access_token=&lt;TOKEN&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">The "sub" parameter</div>
<div class="paragraph">
<p>When using the openid scope, the Authorization Server will always answer with a "sub" parameter that is supposed to identify an End-User with a unique string. This will only be the case for the Authorization Grants mentioned in this Integration Guide. Other flows might collapse all subs into the client_id to avoid unintentionally leaking user information with non-OpenID grants.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="trueauthorization-user-managed-access-uma"><a class="anchor" href="#trueauthorization-user-managed-access-uma"></a>2.2. Authorization: User Managed Access (UMA)</h3>
<div class="sect3">
<h4 id="trueauthorization-flow"><a class="anchor" href="#trueauthorization-flow"></a>2.2.1. Authorization Flow</h4>
<div class="paragraph">
<p>As a summarized flow, Authorization on UMA architectures is implemented with the following workflow:</p>
</div>
<div id="img_oidc_reponse_types" class="imageblock text-center">
<div class="content">
<img src="images/uma.PNG" alt="uma" width="700">
</div>
<div class="title">Figure 2. Authorization Flow using UMA</div>
</div>
</div>
<div class="sect3">
<h4 id="trueresource-managing"><a class="anchor" href="#trueresource-managing"></a>2.2.2. Resource Managing</h4>
<div class="paragraph">
<p>Resource servers (RS) can register and list their registered resources using the API Endpoint (i.e: <a href="https://um.nextgeoss.eu/oxauth/restv1/host/rsrc/resource_set" class="bare">https://um.nextgeoss.eu/oxauth/restv1/host/rsrc/resource_set</a>)</p>
</div>
<div class="paragraph">
<p>In order to interact with the UMA API, an access token must be requested to the Token Endpoint (which is the same as OpenID Connect Token Endpoint) including an additional scope: uma_protection. This special access token is named PAT (Protection API Token). If a RS wants to register a resource, first a POST request must be issued to the token endpoint:</p>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">POST /oxauth/restv1/token -H 'Authorization: Bearer &lt;PAT&gt;' -H 'Content-type: application-json'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Body (JSON)</p>
</div>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
              "name": "&lt;Resource name&gt;",
              "uri": "&lt;Location of the resource&gt;",
              "type": "&lt;Optional&gt;",
              "resource_scopes": [&lt;SCOPE_ARRAY (strings)&gt;],
              "icon_uri": "&lt;ICON_URI&gt;"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The answer to this request will be a JSON with the ID of the resource under the key “_id”.</p>
</div>
<div class="paragraph">
<p>In addition, in case information about registered resources needs to be retrieved the following method is available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET /restv1/host/rsrc/resource_set/&lt;resourceId&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameter “resourceId” must be replaced by the ID of any registered resource. If no resource ID is passed to this Endpoint, the result will be a list of registered resources by the specific RS that performed the request. Additionally, RS owners should manually provide the policies (set of claims) which apply to the resource so they can be registered by an admin on the UMA service. This method will be replaced by a dynamic registration of necessary claims per resource.
Resource Access Request (Client side)</p>
</div>
</div>
<div class="sect3">
<h4 id="truepolicy-enforcement-pep"><a class="anchor" href="#truepolicy-enforcement-pep"></a>2.2.3. Policy Enforcement (PEP)</h4>
<div class="paragraph">
<p>On the server side, 2 steps must be performed: PAT acquisition  and Ticket request generation</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PAT acquisition. will be the same request as the one mentioned on the “Resource Managing” section.</p>
</li>
<li>
<p>Ticket request.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">POST /oxauth/restv1/host/rsrc_pr -H 'Authorization: Bearer &lt;PAT_Token&gt;' -H 'Content-type: application-json'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Body (JSON)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
       "resource_id": "&lt;RS_ID&gt;",
       "resource_scopes": [&lt;SCOPE_ARRAY (strings)&gt;]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result to this request will be a simple JSON (201 Created) with a “ticket” field. On the other hand, if the PAT token is not valid, a 401 Unauthorized response will be issued.</p>
</div>
<div class="paragraph">
<p>This ticket field will be included in a 400 or 403 response by the Resource Server, indicating where it can be exchanged for an Resource Access Token.</p>
</div>
</div>
<div class="sect3">
<h4 id="truepolicy-decision-pdp"><a class="anchor" href="#truepolicy-decision-pdp"></a>2.2.4. Policy Decision (PDP).</h4>
<div class="paragraph">
<p>When acquiring a resource token using a ticket, the UMA service will try to check user claims (such as attributes, user ID, client ID). Some of those claims can’t be gathered using the service itself and the parameters on the request, so it might be necessary to gather those claims and get a new ticket.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">POST /oxauth/restv1/token</code></pre>
</div>
</div>
<div class="paragraph">
<p>Body (Form)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">    scope=&lt;scopes&gt; (separated by a space)
    client_secret=&lt;secret&gt;
    ticket=&lt;ticket&gt;
    client_id=&lt;client_id&gt;
    grant_type=urn:ietf:params:oauth:grant-type:uma-ticket</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the ticket is valid and the user claims are matched, a Resource Token a JSON response with the field “access_token” will be issued. If not, a 403 (Forbidden) response will be issued. This response can have another JSON attached explaining the error. If the error matches the “need_info” string, it is possible to extract an URL from the field “redirect_user” to gather any remaining claims.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">GET  &lt;redirect_user_URI&gt;?ticket=&lt;ticket&gt;&amp;client_id=&lt;client_id&gt;&amp;claims_redirect_uri=&lt;redirect_uri&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The redirect_uri in this request must be specified on the client configuration. This request will result will redirect the user to another location with the response parameters parsed in the URL. One of this parameters should be a new “ticket” that can be used to request the token again, taking into account the gathered claims.</p>
</div>
<div class="paragraph">
<p>In any case, with or without claims, the token endpoint can issue a 403 Forbidden response indicating that the policies in place forbid access to the resource.
Resource Access Grant (Server side)</p>
</div>
</div>
<div class="sect3">
<h4 id="truetoken-introspection"><a class="anchor" href="#truetoken-introspection"></a>2.2.5. Token Introspection</h4>
<div class="paragraph">
<p>A Resource Server should expect a resource token for each access request. If no token is provided, a redirection to the UMA client service should be implemented. If a token is provided, it is possible to “introspect” this token to determine if access to the resource should be granted. The RS should acquire a PAT with the same method used to manage resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs"> POST /oxauth/restv1/rpt/status -H ' Authorization: Bearer &lt;PAT&gt;'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Body (Form)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="url" class="language-url hljs">    Token=&lt;Resource_Access_Token&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. The logic implemented on this webpage should retrieve the token from the URL
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. OpenID scope is mandatory (but its use is optional) and geoss_user is default for this system
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-09-10 16:56:42 +0200
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>